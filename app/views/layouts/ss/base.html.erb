<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes,minimum-scale=1.0,maximum-scale=2.0" />
<title>srsg</title>
<%= stylesheet_link_tag    "ss", media: "all", "data-turbolinks-track" => true %>
<%= javascript_include_tag "ss", "data-turbolinks-track" => true %>
<%= javascript_include_tag "tinymce/tinymce.min.js" %>
<%= csrf_meta_tags %>
</head>
<body>

<div id="page">

<header id="head">
  <div class="wrap">
    <h1><%= link_to "< SS >", sns_mypage_path %></h1>
    <% if @cur_user %>
    <nav>
      <%= link_to "　", "#" %>
      <%= link_to "　", "#" %>
    </nav>
    <nav>
      <%= link_to @cur_user.name, "#" %>
      <%= link_to "Logout", sns_logout_path %>
    </nav>
    <% end %>
  </div>
<!-- /#head --></header>

<% if (crumbs = controller.class.crumbs).size > 0 %>
<nav id="crumbs">
  <%== crumbs.map {|c| instance_exec(&c)}.map {|n, u| link_to n.to_s.humanize, u }.join("/") %>
</nav>
<% end %>

<% if notice %>
<aside id="notice">
  <div class="wrap"><%= notice %></div>
</aside>
<script> setTimeout(function() { $('#notice').fadeOut(); }, 1500); </script>
<% end %>

<div id="<%= controller.class.include?(SS::CrudFilter) ? 'wrap' : 'wrap' %>">
  <div class="wrap">
    
    <div id="navi">
      <% if ::File.exists?("#{Rails.root}/app/views/#{params[:controller]}/_navi.html.erb") %>
      <%= render partial: "navi" %>
      <% end %>
      
      <% if @cur_site %>
      <nav class="main-menu">
        <h1>Root</h1>
        <%= link_to "Articles", cms_articles_path %>
        <%= link_to "Contents", cms_contents_path %>
        <%= link_to "Pages", cms_pages_path %>
        <%= link_to "Nodes", cms_nodes_path %>
        <%= link_to "Pieces", cms_pieces_path %>
        <%= link_to "Layouts", cms_layouts_path %>
      </nav>
      <% end %>
      
      <% if request.path_info == sns_mypage_path %> 
      <nav class="main-menu">
        <h1>My Sites</h1>
        <% SS::Site.all.each do |item| %>
        <%#= link_to item.name, "/.#{item.host}" %>
        <%= link_to item.name, cms_articles_path(item.host) %>
        <% end %>
      </nav>
      <% end %>
      
      <% if request.path_info == sns_mypage_path || request.path_info =~ /^#{sys_main_path}/ %> 
      <nav class="main-menu">
        <h1>System Function<%#= link_to "SYS", sys_main_path %></h1>
        <%= link_to "Users", sys_users_path %>
        <%= link_to "Groups", sys_groups_path %>
        <%= link_to "Sites", sys_sites_path %>
      </nav>
      <% end %>
    </div>

    <% if controller.class.include?(SS::CrudFilter) %>
    <div id="menu">
      <% if ::File.exists?("#{Rails.root}/app/views/#{params[:controller]}/_menu.html.erb") %>
      <%= render partial: "menu" %>
      <% else %>
      <%= render file: "ss/crud/_menu" %>
      <% end %>
    <!-- /#menu --></div>
    <% end %>
    
    <article id="main">
      <div class="wrap">
      <%= yield %>
      </div>
    <!-- /#main --></article>
    
  <!-- /.wrap --></div>
<!-- /#wrap --></div>

<footer id="foot">
  <div class="wrap">
    SS Project
  </div>
<!-- /#foot --></footer>

<!-- /#page --></div>

</body>
</html>
