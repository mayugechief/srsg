#!/usr/bin/env ruby

files = Dir.glob("#{File.dirname(__dir__)}/tmp/pids/*.pid")

if files.size == 0
  puts "Thin server is not running."
else
  files.each do |file|
    pid = File.read(file)
    puts "Restart Thin server. [PID=#{pid}]"
    `kill -HUP #{pid}` if `ps aux | grep "thin [s]erver" | grep #{pid}`.strip != ""
  end
end

puts "\n" + ("-"*80) + "\n" + `ps aux | grep "[t]hin server\\|[P]ID"`.strip + "\n" + ("-"*80)
